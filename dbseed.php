<?php
require 'bootstrap.php';

$statement = <<<EOS
DROP TABLE IF EXISTS `tasks`;

CREATE TABLE `tasks` (
  `id` varchar(256) NOT NULL DEFAULT '',
  `submitter_id` varchar(256) DEFAULT NULL,
  `priority` int(2) DEFAULT NULL,
  `command` blob,
  `status` varchar(16) DEFAULT NULL,
  `created` datetime DEFAULT NULL,
  `totaltime` int(8) DEFAULT NULL,
  `processor_id` varchar(256) DEFAULT NULL,
  `updated` datetime DEFAULT NULL,

  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

LOCK TABLES `tasks` WRITE;
/*!40000 ALTER TABLE `tasks` DISABLE KEYS */;

INSERT INTO `tasks` (`id`, `submitter_id`, `priority`, `command`, `status`, `created`, `updated`, `totaltime`, `processor_id`)
VALUES
	('5e7f09d22ef82','5',5,X'53617920736F6D657468696E672049276D20676976696E67207570206F6E20796F75','FAILED','2020-03-28 01:24:50','2020-03-28 01:24:50',2002,'29fb'),
	('5e7f09d7e29fb','77',5,X'57652063616E742073746F70','COMPLETED','2020-03-28 01:24:55','2020-03-28 01:24:55',30003,'r2d2'),
	('5e7f09dbc2433','876545',5,X'53617920736F6D657468696E672049276D20676976696E67207570206F6E20796F75','COMPLETED','2020-03-28 01:24:59','2020-03-28 01:24:59',40401,'c3po'),
	('5e7f09dd3a9f6','2223',5,X'43616C6C206D65206D61796265','IN_PROGRESS','2020-03-28 01:25:01','2020-03-28 01:25:01',NULL,'azi3'),
	('5e7f09de498fc','666',5,X'53617920736F6D657468696E672049276D20676976696E67207570206F6E20796F75','IN_PROGRESS','2020-03-28 01:25:02','2020-03-28 01:25:02',NULL,'bb8'),
	('5e7f09df478d0','123',5,X'53617920736F6D657468696E672049276D20676976696E67207570206F6E20796F75','NEW','2020-03-28 01:25:03','2020-03-28 01:25:03',NULL,NULL),
	('5e7f09e042d94','876545',5,X'4F6F70732C20692064696420697420616761696E','NEW','2020-03-28 01:25:04','2020-03-28 01:25:04',NULL,NULL),
	('5e7f09e1356dc','123',5,X'53617920736F6D657468696E672049276D20676976696E67207570206F6E20796F75','NEW','2020-03-28 01:25:05','2020-03-28 01:25:05',NULL,NULL),
	('5e7f09e2333fd','876545',5,X'53617920736F6D657468696E672049276D20676976696E67207570206F6E20796F75','NEW','2020-03-28 01:25:06','2020-03-28 01:25:06',NULL,NULL),
	('5e7f09e336924','666',5,X'53617920736F6D657468696E672049276D20676976696E67207570206F6E20796F75','NEW','2020-03-28 01:25:07','2020-03-28 01:25:07',NULL,NULL);

/*!40000 ALTER TABLE `tasks` ENABLE KEYS */;
UNLOCK TABLES;
EOS;

try {
    $createTable = $dbConnection->exec($statement);
    echo "Database startup completed\n";
} catch (\PDOException $e) {
    exit($e->getMessage());
}